/**
 * FEED_ARCHITECTURE.txt
 * System Architecture and Component Relationships
 */

================================================================================
                    FEED SYSTEM ARCHITECTURE (v1.0.0)
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          APPLICATION STRUCTURE                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

App Router
  â””â”€ /feed
     â””â”€ StudentFeed (Main Container)
        â”œâ”€ Header (Title + Refresh Button)
        â”œâ”€ FeedFilter (Content Filters)
        â”œâ”€ PostCreator (Create New Post)
        â”œâ”€ PostsContainer (Feed Items)
        â”‚  â”œâ”€ PostCard 1
        â”‚  â”‚  â”œâ”€ Author Info
        â”‚  â”‚  â”œâ”€ Media Gallery (Images/Videos)
        â”‚  â”‚  â”œâ”€ PostReactions (Emoji Picker)
        â”‚  â”‚  â”œâ”€ PostComments (Thread)
        â”‚  â”‚  â”‚  â””â”€ CommentItem (Individual)
        â”‚  â”‚  â”‚     â”œâ”€ CommentReactions
        â”‚  â”‚  â”‚     â””â”€ ModeratorControls
        â”‚  â”‚  â””â”€ Actions (Delete/Share)
        â”‚  â”œâ”€ PostCard 2
        â”‚  â”œâ”€ LoadMoreButton
        â”‚  â””â”€ [More posts...]
        â””â”€ SuggestedContent (Sidebar)
           â”œâ”€ Tab: Materials
           â”‚  â””â”€ MaterialCard (Save, Link)
           â”œâ”€ Tab: Events
           â”‚  â””â”€ EventCard (Date, Register)
           â””â”€ Tab: Trending
              â””â”€ TrendingItem (Rank, Stats)


================================================================================
                           DATA FLOW DIAGRAM
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ StudentFeed  â”‚ Main state management
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â†“
â”œâ”€ posts[]              Current posts array
â”œâ”€ filteredPosts[]      Posts after filtering
â”œâ”€ activeFilter         Current filter (all|lessons|groups|friends)
â”œâ”€ isLoadingPosts       Loading state
â”œâ”€ error                Error message
â”œâ”€ pageInfo             { page, hasMore, total }
â”œâ”€ isMobileLayout       Responsive state
â””â”€ showSuggestions      Sidebar visibility
  
  â†“
  
postInteractionService.js
â”œâ”€ getFeed()            Fetch filtered posts with pagination
â”œâ”€ createPost()         Create new post
â”œâ”€ addPostReaction()    Add emoji reaction
â”œâ”€ getPostComments()    Fetch comments
â”œâ”€ addComment()         Create comment
â”œâ”€ uploadPostImage()    Upload image file
â”œâ”€ uploadPostVideo()    Upload video file
â”œâ”€ approvePost()        Teacher moderation
â”œâ”€ rejectPost()         Teacher moderation
â”œâ”€ getSuggestedMaterials() Fetch materials
â”œâ”€ getUpcomingEvents()  Fetch events
â””â”€ getTrendingPosts()   Fetch trending posts
  
  â†“
  
API Server (or Mock Service)
â”œâ”€ GET  /api/v1/feed
â”œâ”€ POST /api/v1/posts
â”œâ”€ PUT  /api/v1/posts/{id}
â”œâ”€ DELETE /api/v1/posts/{id}
â”œâ”€ POST /api/v1/posts/{id}/reactions
â”œâ”€ GET  /api/v1/posts/{id}/comments
â”œâ”€ POST /api/v1/posts/{id}/comments
â”œâ”€ GET  /api/v1/suggestions/materials
â”œâ”€ GET  /api/v1/suggestions/events
â”œâ”€ GET  /api/v1/posts/trending
â”œâ”€ POST /api/v1/posts/{id}/approve
â””â”€ POST /api/v1/posts/{id}/reject


================================================================================
                       COMPONENT HIERARCHY DIAGRAM
================================================================================

StudentFeed
â”‚
â”œâ”€ FeedFilter
â”‚  â””â”€ Props: activeFilter, onFilterChange
â”‚
â”œâ”€ PostCreator (Reused from existing)
â”‚  â””â”€ Props: onPostCreated, placeholder
â”‚
â”œâ”€ PostCard[] (Reused from existing)
â”‚  â”œâ”€ PostReactions (Reused from existing)
â”‚  â”‚  â””â”€ Props: postId, userReaction, onReaction, isLoading
â”‚  â”‚
â”‚  â””â”€ PostComments (Reused from existing)
â”‚     â”œâ”€ Props: postId, isTeacher, onCommentAdded
â”‚     â”‚
â”‚     â””â”€ CommentItem[] (Reused from existing)
â”‚        â”œâ”€ Props: comment, postId, isTeacher, onDelete
â”‚        â””â”€ Reactions & Moderation controls
â”‚
â””â”€ SuggestedContent
   â”œâ”€ Props: userId, friendIds, groupIds
   â”‚
   â”œâ”€ MaterialsTab
   â”‚  â””â”€ MaterialCard[] (Save, Link)
   â”‚
   â”œâ”€ EventsTab
   â”‚  â””â”€ EventCard[] (Register, Date)
   â”‚
   â””â”€ TrendingTab
      â””â”€ TrendingItem[] (Rank, Link)


================================================================================
                          STATE MANAGEMENT FLOW
================================================================================

Initial Load:
  Component Mounts
    â†“
  useEffect â†’ loadFeed(activeFilter, 1)
    â†“
  postInteractionService.getFeed()
    â†“
  Response â†’ setPosts(), setFilteredPosts(), setPageInfo()
    â†“
  Render PostCard[] with posts


Filter Change:
  User clicks filter tab
    â†“
  handleFilterChange(newFilter)
    â†“
  setActiveFilter(newFilter)
    â†“
  Reset pagination: setPageInfo({ page: 1, ... })
    â†“
  useEffect triggers â†’ loadFeed(newFilter, 1)
    â†“
  Render updated posts


Load More:
  User clicks "Load More" button
    â†“
  handleLoadMore()
    â†“
  loadFeed(activeFilter, page + 1)
    â†“
  setPosts([...existingPosts, ...newPosts])
    â†“
  Append to feed


Post Creation:
  User submits PostCreator form
    â†“
  handlePostCreated(newPost)
    â†“
  setPosts([newPost, ...posts])
    â†“
  New post appears at top of feed


Reaction Added:
  User adds emoji reaction
    â†“
  postInteractionService.addPostReaction()
    â†“
  Post updated with new reaction
    â†“
  handlePostUpdated(updatedPost)
    â†“
  Update posts[] and re-render PostCard


Comment Added:
  User submits comment form
    â†“
  postInteractionService.addComment()
    â†“
  Comment added to post (pending status)
    â†“
  PostComments re-renders with new comment


================================================================================
                         STYLE INHERITANCE FLOW
================================================================================

Global Styles (in App or index.css)
  â†“
StudentFeed.css (Main layout)
  â”œâ”€ .student-feed
  â”œâ”€ .feed-container (Grid 2-column on desktop)
  â”œâ”€ .feed-main
  â”œâ”€ .feed-sidebar
  â””â”€ Media queries for responsive
  
  â†“
FeedFilter.css (Filter bar)
  â”œâ”€ .feed-filter
  â”œâ”€ .filter-button
  â”œâ”€ .filter-button.active
  â””â”€ Media queries
  
  â†“
SuggestedContent.css (Sidebar)
  â”œâ”€ .suggested-content
  â”œâ”€ .suggestion-tabs
  â”œâ”€ .material-card
  â”œâ”€ .event-card
  â”œâ”€ .trending-item
  â””â”€ Media queries


Imported Components (Existing):
  PostCard.css â†’ Post display
  PostCreator.css â†’ Form styling
  PostComments.css â†’ Comments section
  PostReactions.css â†’ Emoji picker


================================================================================
                          RESPONSIVE LAYOUT FLOW
================================================================================

Desktop (1024px+):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Feed Header                             â”‚
  â”‚  Filter Bar                              â”‚
  â”‚  Post Creator                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
  â”‚  â”‚                          â”‚  Materialsâ”‚â”‚
  â”‚  â”‚  Post Feed               â”‚  Events  â”‚â”‚
  â”‚  â”‚  (Infinite Scroll)       â”‚  Trendingâ”‚â”‚
  â”‚  â”‚                          â”‚          â”‚â”‚
  â”‚  â”‚  PostCard                â”‚  Sidebar â”‚â”‚
  â”‚  â”‚  PostCard                â”‚  (Sticky)â”‚â”‚
  â”‚  â”‚  PostCard                â”‚          â”‚â”‚
  â”‚  â”‚                          â”‚          â”‚â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Tablet (768-1023px):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Feed Header             â”‚
  â”‚  Filter Bar              â”‚
  â”‚  Post Creator            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                    â”‚  â”‚
  â”‚  â”‚  Post Feed         â”‚  â”‚
  â”‚  â”‚  (Full Width)      â”‚  â”‚
  â”‚  â”‚                    â”‚  â”‚
  â”‚  â”‚  PostCard          â”‚  â”‚
  â”‚  â”‚  PostCard          â”‚  â”‚
  â”‚  â”‚  PostCard          â”‚  â”‚
  â”‚  â”‚  [Load More]       â”‚  â”‚
  â”‚  â”‚                    â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚  [ğŸ’¡ Show Suggestions]   â”‚  (Floating button)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Mobile (<768px):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Feed Header      â”‚
  â”‚ [Filter â†’]       â”‚ (Horizontal scroll)
  â”‚ Post Creator     â”‚
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚ â”‚              â”‚ â”‚
  â”‚ â”‚ Post Feed    â”‚ â”‚
  â”‚ â”‚ (Full Width) â”‚ â”‚
  â”‚ â”‚              â”‚ â”‚
  â”‚ â”‚ PostCard     â”‚ â”‚
  â”‚ â”‚ PostCard     â”‚ â”‚
  â”‚ â”‚              â”‚ â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚                  â”‚
  â”‚  [ğŸ’¡ Suggest] â¤´ â”‚ (Floating button)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  + Sidebar Overlay (when toggled):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Materials | âœ•    â”‚
  â”‚ Events           â”‚
  â”‚ Trending         â”‚
  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚ [Material Card] â”‚
  â”‚ [Material Card] â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                        SERVICE LAYER STRUCTURE
================================================================================

postInteractionService.js
â”‚
â”œâ”€ Constants
â”‚  â”œâ”€ API_BASE_URL: string
â”‚  â”œâ”€ USE_MOCK_SERVICE: boolean
â”‚  â”œâ”€ REACTION_TYPES: object
â”‚  â”œâ”€ REACTION_EMOJIS: object
â”‚  â””â”€ COMMENT_STATUS: object
â”‚
â”œâ”€ Helper Functions
â”‚  â”œâ”€ getToken(): string
â”‚  â”œâ”€ getHeaders(includeAuth): object
â”‚  â””â”€ [Utility functions]
â”‚
â”œâ”€ Core Methods
â”‚  â”œâ”€ Feed Management
â”‚  â”‚  â””â”€ getFeed(options): Promise<FeedResponse>
â”‚  â”‚
â”‚  â”œâ”€ Post Management
â”‚  â”‚  â”œâ”€ createPost(data): Promise<PostResponse>
â”‚  â”‚  â”œâ”€ updatePost(id, data): Promise<PostResponse>
â”‚  â”‚  â””â”€ deletePost(id): Promise<Response>
â”‚  â”‚
â”‚  â”œâ”€ Reactions
â”‚  â”‚  â”œâ”€ addPostReaction(postId, type): Promise<Response>
â”‚  â”‚  â”œâ”€ removePostReaction(postId): Promise<Response>
â”‚  â”‚  â””â”€ addCommentReaction(postId, commentId, type): Promise<Response>
â”‚  â”‚
â”‚  â”œâ”€ Comments
â”‚  â”‚  â”œâ”€ getPostComments(postId): Promise<CommentsResponse>
â”‚  â”‚  â”œâ”€ addComment(postId, data): Promise<CommentResponse>
â”‚  â”‚  â”œâ”€ updateComment(postId, commentId, data): Promise<Response>
â”‚  â”‚  â””â”€ deleteComment(postId, commentId): Promise<Response>
â”‚  â”‚
â”‚  â”œâ”€ Media
â”‚  â”‚  â”œâ”€ uploadPostImage(file, postId): Promise<UploadResponse>
â”‚  â”‚  â””â”€ uploadPostVideo(file, postId): Promise<UploadResponse>
â”‚  â”‚
â”‚  â”œâ”€ Moderation
â”‚  â”‚  â”œâ”€ approvePost(postId): Promise<Response>
â”‚  â”‚  â”œâ”€ rejectPost(postId, reason): Promise<Response>
â”‚  â”‚  â”œâ”€ approveComment(postId, commentId): Promise<Response>
â”‚  â”‚  â””â”€ rejectComment(postId, commentId, reason): Promise<Response>
â”‚  â”‚
â”‚  â””â”€ Suggestions
â”‚     â”œâ”€ getSuggestedMaterials(options): Promise<MaterialsResponse>
â”‚     â”œâ”€ getUpcomingEvents(options): Promise<EventsResponse>
â”‚     â””â”€ getTrendingPosts(options): Promise<PostsResponse>
â”‚
â”œâ”€ Mock Data
â”‚  â””â”€ mockData
â”‚     â”œâ”€ posts[]
â”‚     â””â”€ comments[]
â”‚
â””â”€ Fallback Mechanism
   â””â”€ On error â†’ Use mock service â†’ Return with message


================================================================================
                           FILTER FLOW DIAGRAM
================================================================================

User selects filter:
  "All" / "Lessons" / "Groups" / "Friends"
    â†“
FeedFilter.onFilterChange(filterId)
    â†“
StudentFeed.handleFilterChange(filterId)
    â†“
setActiveFilter(filterId)
    â†“
Reset pagination: setPageInfo({ page: 1, hasMore: true, total: 0 })
    â†“
useEffect dependency: [activeFilter] triggers
    â†“
loadFeed(filterId, 1)
    â†“
postInteractionService.getFeed({
  filterType: filterId,
  page: 1,
  limit: 10,
  userId: getCurrentUserId(),
  friendIds: getCurrentUserFriends(),
  groupIds: getCurrentUserGroups()
})
    â†“
Service processes:
  â€¢ Apply filter logic (switch on filterType)
  â€¢ Map posts to matching criteria
  â€¢ Sort by date (newest first)
  â€¢ Paginate results
    â†“
Return: { success, data: posts[], hasMore, total }
    â†“
setPosts(filteredPosts)
setFilteredPosts(filteredPosts)
setPageInfo({ page: 1, hasMore, total })
    â†“
Component re-renders with filtered posts


================================================================================
                        RESPONSIVE BEHAVIOR
================================================================================

Window Resize Listener:
  window.addEventListener('resize', checkMobileLayout)
    â†“
  checkMobileLayout():
    if (window.innerWidth < 1024)
      setIsMobileLayout(true)
      setShowSuggestions(false) // Hide sidebar
    else
      setIsMobileLayout(false)
      setShowSuggestions(true)  // Show sidebar
    â†“
  Render different layout based on isMobileLayout flag


Mobile Sidebar Toggle:
  On mobile (< 1024px):
    â”œâ”€ Hide: .feed-sidebar { display: none }
    â””â”€ Show: Floating button "ğŸ’¡ Gá»£i Ã½ & Sá»± kiá»‡n"
      â†“
      User clicks button
        â†“
      setShowSuggestions(true)
        â†“
      Render: .mobile-suggestions-overlay
        â”œâ”€ Background overlay (rgba(0,0,0,0.5))
        â”œâ”€ Header with "Gá»£i Ã½ & Sá»± kiá»‡n" and close button (âœ•)
        â””â”€ SuggestedContent component
      â†“
      User clicks overlay or close button
        â†“
      setShowSuggestions(false)
        â†“
      Remove overlay


CSS Media Query Behavior:
  @media (max-width: 1023px)
    â””â”€ feed-sidebar { display: none }
    
  @media (max-width: 768px)
    â””â”€ Adjust padding, font sizes
       Reduce gaps between elements
       
  @media (max-width: 480px)
    â””â”€ Extra compact layout
       Hide labels on tiny screens
       Single column for all


================================================================================
                    ERROR HANDLING & STATE FLOW
================================================================================

API Call Fails:
  postInteractionService.getFeed()
    â†“ (Error caught)
    â†“
  catch (error):
    â””â”€ Return { success: false, message: error.message }
    â†“
  Student Feed receives failed response
    â†“
  if (!result.success):
    â””â”€ setError(result.message)
    â””â”€ Display error banner
    â””â”€ Keep previous posts visible
    â†“
  User sees:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ âœ— Error loading feed        â”‚
    â”‚                         [Ã—] â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    + (Previous posts still visible)
    â†“
  User can:
    â€¢ Click [Refresh] button to retry
    â€¢ Click [Ã—] to dismiss error
    â€¢ Scroll to see cached posts


Loading State:
  setIsLoadingPosts(true)
    â†“
  Show: Spinner with "Loading your feed..."
    â†“
  API call in progress...
    â†“
  Response received
    â†“
  setIsLoadingPosts(false)
    â†“
  Show: Posts or empty state


Empty State:
  No posts found for current filter
    â†“
  Show: Empty state message
    â”œâ”€ Icon: ğŸ“­
    â”œâ”€ Heading: "KhÃ´ng cÃ³ bÃ i viáº¿t nÃ o"
    â””â”€ Message: (varies by filter type)
       â”œâ”€ "All": "HÃ£y táº¡o bÃ i viáº¿t Ä‘áº§u tiÃªn!"
       â”œâ”€ "Friends": "HÃ£y káº¿t báº¡n Ä‘á»ƒ xem hoáº¡t Ä‘á»™ng"
       â”œâ”€ "Groups": "HÃ£y tham gia nhÃ³m Ä‘á»ƒ xem bÃ i viáº¿t"
       â””â”€ "Lessons": "HÃ£y Ä‘Äƒng kÃ½ khÃ³a há»c..."


================================================================================
                    PERFORMANCE OPTIMIZATION NOTES
================================================================================

Optimizations in Place:
  â€¢ useCallback for event handlers (prevents re-creation)
  â€¢ Pagination: Load 10 posts at a time (not all)
  â€¢ Memoization: useMemo for computed values (if needed)
  â€¢ CSS: Optimized media queries (mobile-first)
  â€¢ Service: Mock data has 500ms simulated delay (realistic)
  â€¢ Ref usage: useRef for outside-click detection (modals)

Future Optimizations:
  â€¢ useReducer for complex state management
  â€¢ Component code splitting with React.lazy
  â€¢ Image lazy loading with Intersection Observer
  â€¢ Virtual scrolling for very large feeds
  â€¢ Service worker for offline support


================================================================================
                           SUMMARY
================================================================================

This architecture provides:
  âœ… Clean component hierarchy
  âœ… Centralized state management
  âœ… Modular service layer
  âœ… Responsive design with 4 breakpoints
  âœ… Error handling throughout
  âœ… Loading states for user feedback
  âœ… Infinite scroll pagination
  âœ… Mock data for testing
  âœ… Real API integration ready
  âœ… Production-ready code structure

Generated: 2024-01-15
Version: 1.0.0
