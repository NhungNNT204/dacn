# Chat System - Architecture & Data Flow Diagrams

## 1. Component Hierarchy

```
StudentChat (Main Container)
â”‚
â”œâ”€â”€ Error Banner
â”‚   â””â”€â”€ Display global errors
â”‚
â”œâ”€â”€ ChatSidebar
â”‚   â”œâ”€â”€ Header
â”‚   â”‚   â”œâ”€â”€ Title: "Tin nháº¯n"
â”‚   â”‚   â””â”€â”€ New Chat Button
â”‚   â”‚
â”‚   â”œâ”€â”€ Search Bar
â”‚   â”‚   â”œâ”€â”€ Search Input
â”‚   â”‚   â”œâ”€â”€ Clear Button
â”‚   â”‚   â””â”€â”€ Search Icon
â”‚   â”‚
â”‚   â”œâ”€â”€ Filter Tabs
â”‚   â”‚   â”œâ”€â”€ Tab: All
â”‚   â”‚   â”œâ”€â”€ Tab: Private (1:1)
â”‚   â”‚   â”œâ”€â”€ Tab: Group
â”‚   â”‚   â””â”€â”€ Tab: Broadcast
â”‚   â”‚
â”‚   â””â”€â”€ Conversations List
â”‚       â”œâ”€â”€ Conversation Item
â”‚       â”‚   â”œâ”€â”€ Avatar (with online indicator)
â”‚       â”‚   â”œâ”€â”€ Conversation Info
â”‚       â”‚   â”‚   â”œâ”€â”€ Name
â”‚       â”‚   â”‚   â”œâ”€â”€ Preview Text
â”‚       â”‚   â”‚   â””â”€â”€ Timestamp
â”‚       â”‚   â”œâ”€â”€ Type Badge
â”‚       â”‚   â””â”€â”€ Unread Badge
â”‚       â”œâ”€â”€ Conversation Item
â”‚       â””â”€â”€ (... more items)
â”‚
â”œâ”€â”€ ChatWindow
â”‚   â”œâ”€â”€ Header
â”‚   â”‚   â”œâ”€â”€ Avatar
â”‚   â”‚   â”œâ”€â”€ Info
â”‚   â”‚   â”‚   â”œâ”€â”€ Name
â”‚   â”‚   â”‚   â””â”€â”€ Status/Member Count
â”‚   â”‚   â””â”€â”€ Actions
â”‚   â”‚       â”œâ”€â”€ Phone Call
â”‚   â”‚       â”œâ”€â”€ Video Call
â”‚   â”‚       â”œâ”€â”€ More Options
â”‚   â”‚       â””â”€â”€ Close (Mobile)
â”‚   â”‚
â”‚   â”œâ”€â”€ Error Banner (if any)
â”‚   â”‚
â”‚   â”œâ”€â”€ Messages Container
â”‚   â”‚   â”œâ”€â”€ Date Divider
â”‚   â”‚   â”‚   â””â”€â”€ "HÃ´m nay"
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Message Group (Received)
â”‚   â”‚   â”‚   â”œâ”€â”€ Avatar
â”‚   â”‚   â”‚   â””â”€â”€ Message
â”‚   â”‚   â”‚       â”œâ”€â”€ Sender Name
â”‚   â”‚   â”‚       â”œâ”€â”€ Message Bubble
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ Content (text/image/video/file/mixed)
â”‚   â”‚   â”‚       â””â”€â”€ Timestamp
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Message Group (Sent)
â”‚   â”‚   â”‚   â””â”€â”€ Message
â”‚   â”‚   â”‚       â”œâ”€â”€ Message Bubble
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ Content
â”‚   â”‚   â”‚       â”œâ”€â”€ Status Indicator
â”‚   â”‚   â”‚       â””â”€â”€ Timestamp
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Date Divider
â”‚   â”‚   â””â”€â”€ (... more messages)
â”‚   â”‚
â”‚   â”œâ”€â”€ Typing Indicators (if any)
â”‚   â”‚   â””â”€â”€ "User Name Ä‘ang nháº­p..."
â”‚   â”‚
â”‚   â””â”€â”€ Message Input
â”‚       â”œâ”€â”€ Attachments Preview (if any)
â”‚       â”œâ”€â”€ Error Message (if any)
â”‚       â”œâ”€â”€ Input Area
â”‚       â”‚   â”œâ”€â”€ Textarea
â”‚       â”‚   â”œâ”€â”€ Emoji Picker
â”‚       â”‚   â”œâ”€â”€ File Attach
â”‚       â”‚   â”œâ”€â”€ Image Upload
â”‚       â”‚   â”œâ”€â”€ Video Upload
â”‚       â”‚   â””â”€â”€ Send Button
â”‚       â””â”€â”€ Character Count (if >4500)
â”‚
â”œâ”€â”€ New Chat Modal (when visible)
â”‚   â”œâ”€â”€ Header
â”‚   â”‚   â”œâ”€â”€ Title
â”‚   â”‚   â””â”€â”€ Close Button
â”‚   â”‚
â”‚   â”œâ”€â”€ Body
â”‚   â”‚   â”œâ”€â”€ Group Name Input (if group)
â”‚   â”‚   â”œâ”€â”€ Search Users
â”‚   â”‚   â”œâ”€â”€ Selected Users Chips
â”‚   â”‚   â””â”€â”€ Available Users List
â”‚   â”‚
â”‚   â””â”€â”€ Footer
â”‚       â”œâ”€â”€ Cancel Button
â”‚       â””â”€â”€ Create Button
â”‚
â””â”€â”€ Mobile Sidebar Toggle
    â””â”€â”€ Menu Button (on mobile)
```

---

## 2. Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Application Start                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Initialize ChatService     â”‚
        â”‚  - Load WebSocket URL       â”‚
        â”‚  - Load API URL             â”‚
        â”‚  - Setup Event Listeners    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Load Conversations         â”‚
        â”‚  getConversations()         â”‚
        â”‚  Returns: []                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Render Conversation List   â”‚
        â”‚  - Display in sidebar       â”‚
        â”‚  - Select first by default  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Load Messages              â”‚
        â”‚  getMessages(convId)        â”‚
        â”‚  Returns: []                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Subscribe to Events        â”‚
        â”‚  - onMessage()              â”‚
        â”‚  - onTyping()               â”‚
        â”‚  - onStatusChange()         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Chat Ready for User        â”‚
        â”‚  All conversations loaded   â”‚
        â”‚  Messages displayed         â”‚
        â”‚  Events subscribed          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Message Send Flow

```
User Types Message
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Validation   â”‚
â”‚ - Has content?     â”‚
â”‚ - < 5000 chars?    â”‚
â”‚ - Has attachment?  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ Valid?  â”‚
    â””â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
     â”‚      â”‚
    Yes    No â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                         â”‚
     â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
     â”‚                    â”‚ Show Errorâ”‚
     â”‚                    â”‚ Banner    â”‚
     â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Send Message        â”‚
â”‚ sendMessage(...)    â”‚
â”‚ - Set status: sent  â”‚
â”‚ - Show in chat      â”‚
â”‚ - Add to store      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ Success?â”‚
    â””â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
     â”‚      â”‚
    Yes    No â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                         â”‚
     â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
     â”‚                    â”‚ Show Errorâ”‚
     â”‚                    â”‚ Retry Opt?â”‚
     â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WebSocket: Message   â”‚
â”‚ Broadcast to others  â”‚
â”‚ - Update timestamp   â”‚
â”‚ - Mark: delivered    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update UI            â”‚
â”‚ - Clear input        â”‚
â”‚ - Reset attachments  â”‚
â”‚ - Reset preview      â”‚
â”‚ - Focus input again  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Conversation Selection Flow

```
User Clicks Conversation
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Set Active Conv  â”‚
â”‚ Update state     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Load Messages    â”‚
â”‚ getMessages()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ Success?â”‚
    â””â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
     â”‚      â”‚
    Yes    No â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                  â”‚
     â”‚            â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”
     â”‚            â”‚ Show   â”‚
     â”‚            â”‚ Error  â”‚
     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Chat Msgs â”‚
â”‚ - Group by date  â”‚
â”‚ - Format time    â”‚
â”‚ - Render avatars â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Subscribe to Msgsâ”‚
â”‚ onMessage()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Auto-scroll      â”‚
â”‚ To latest msg    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Input     â”‚
â”‚ Focus textarea   â”‚
â”‚ Ready to type    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Search Flow

```
User Types in Search
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Debounce        â”‚
â”‚ Wait for input  â”‚
â”‚ completion      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Search Convs    â”‚
â”‚ searchConvs()   â”‚
â”‚ Query: "string" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Filter Results  â”‚
â”‚ By type too     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Display  â”‚
â”‚ Show results    â”‚
â”‚ Show count      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. File Upload Flow

```
User Clicks File Button
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Open File Dialogâ”‚
â”‚ Accept: any     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Selects    â”‚
â”‚ File(s)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validate        â”‚
â”‚ - File size OK? â”‚
â”‚ - Count OK?     â”‚
â”‚ - Type OK?      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
     â”‚        â”‚
    Yes      No â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                    â”‚
     â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”
     â”‚            â”‚ Show     â”‚
     â”‚            â”‚ Error    â”‚
     â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Read File as    â”‚
â”‚ Data URL        â”‚
â”‚ (for preview)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show Preview    â”‚
â”‚ - Image: thumb  â”‚
â”‚ - Video: icon   â”‚
â”‚ - File: icon    â”‚
â”‚ - Can remove    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ready to Send   â”‚
â”‚ With Message    â”‚
â”‚ and Attachment  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. WebSocket Event Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WebSocket Connected     â”‚
â”‚  URL: ws://server/ws     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                               â”‚
    â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Message Event       â”‚    â”‚ Typing Event        â”‚
â”‚ type: message       â”‚    â”‚ type: typing        â”‚
â”‚ - Receive message   â”‚    â”‚ - Receive typing    â”‚
â”‚ - Add to store      â”‚    â”‚ - Show indicator    â”‚
â”‚ - Render in UI      â”‚    â”‚ - Auto-hide (3s)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                               â”‚
    â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Status Event        â”‚    â”‚ Read Event          â”‚
â”‚ type: status        â”‚    â”‚ type: read          â”‚
â”‚ - User online/off   â”‚    â”‚ - Mark as read      â”‚
â”‚ - Update indicator  â”‚    â”‚ - Remove unread     â”‚
â”‚ - Show in sidebar   â”‚    â”‚ - Update badge      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. State Management

```
StudentChat State
â”œâ”€â”€ selectedConversation: Object
â”‚   â”œâ”€â”€ id: String
â”‚   â”œâ”€â”€ type: '1:1' | 'group' | 'broadcast'
â”‚   â”œâ”€â”€ name: String
â”‚   â””â”€â”€ ... (other fields)
â”‚
â”œâ”€â”€ conversations: Array<Conversation>
â”‚   â”œâ”€â”€ [0]: { id, type, name, ... }
â”‚   â”œâ”€â”€ [1]: { id, type, name, ... }
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ isMobileMenuOpen: Boolean
â”‚
â”œâ”€â”€ isInitializing: Boolean
â”‚
â”œâ”€â”€ error: String | null
â”‚
â”œâ”€â”€ showNewChatModal: Boolean
â”‚
â””â”€â”€ newChatType: '1:1' | 'group' | null

ChatWindow State
â”œâ”€â”€ messages: Array<Message>
â”‚   â”œâ”€â”€ [0]: { id, content, senderId, ... }
â”‚   â”œâ”€â”€ [1]: { id, content, senderId, ... }
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ isLoadingMessages: Boolean
â”‚
â”œâ”€â”€ typingUsers: Array<Object>
â”‚   â”œâ”€â”€ [0]: { userId, userName }
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ error: String | null

ChatSidebar State
â”œâ”€â”€ conversations: Array<Conversation>
â”‚
â”œâ”€â”€ filteredConversations: Array<Conversation>
â”‚
â”œâ”€â”€ searchQuery: String
â”‚
â”œâ”€â”€ isLoading: Boolean
â”‚
â”œâ”€â”€ selectedFilter: 'all' | '1:1' | 'group' | 'broadcast'
â”‚
â””â”€â”€ showNewChatMenu: Boolean

MessageInput State
â”œâ”€â”€ message: String
â”‚
â”œâ”€â”€ attachments: Array<Attachment>
â”‚   â”œâ”€â”€ [0]: { id, file, type, name, size, url }
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ isLoading: Boolean
â”‚
â”œâ”€â”€ error: String | null
â”‚
â”œâ”€â”€ showEmojiPicker: Boolean
â”‚
â””â”€â”€ (listeners cleared on unmount)
```

---

## 9. Message Types Rendering

```
Text Message
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Message Bubble      â”‚
â”‚ "Hello everyone!"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Image Message
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Image Preview]     â”‚
â”‚ Click to zoom       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Video Message
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¶ [Video Player]    â”‚
â”‚   Duration: 2:34    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

File Message
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ document.pdf     â”‚
â”‚ 2.5 MB  â¬‡ Download â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Mixed Message
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "Check these out!"  â”‚
â”‚ [Image] [Image]     â”‚
â”‚ [File]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. Responsive Layout Breakpoints

```
Desktop (1024px+)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Sidebar  â”‚  â”‚  Chat Window   â”‚ â”‚
â”‚ â”‚ 320px    â”‚  â”‚  flex (full)   â”‚ â”‚
â”‚ â”‚          â”‚  â”‚                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tablet (768-1023px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â˜°] Chat Window              â”‚
â”‚ Sidebar toggles via button   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Mobile (480-767px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â˜°] Chat Window    â”‚
â”‚ Full width         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Small (<480px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â˜°] Chat    â”‚
â”‚ Compact      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. Error Handling Flow

```
Any Operation
       â”‚
       â–¼
    Try Block
       â”‚
    â”Œâ”€â”€â”´â”€â”€â”
    â”‚     â”‚
Success   Error
    â”‚     â”‚
    â”‚     â–¼
    â”‚  Catch Error
    â”‚     â”‚
    â”‚     â–¼
    â”‚  Show Banner
    â”‚  - Red background
    â”‚  - Error icon
    â”‚  - Error message
    â”‚  - Close button
    â”‚     â”‚
    â”‚     â–¼
    â”‚  Log to Console
    â”‚     â”‚
    â”‚     â–¼
    â”‚  Suggest Recovery
    â”‚  - Retry button
    â”‚  - Clear button
    â”‚     â”‚
    â””â”€â”€â”¬â”€â”€â”˜
       â”‚
       â–¼
Return to UI
Continue app
```

---

## 12. Performance Optimization

```
Component Render Optimization
â”œâ”€â”€ Memoization
â”‚   â”œâ”€â”€ useCallback for handlers
â”‚   â”œâ”€â”€ useMemo for filtered lists
â”‚   â””â”€â”€ React.memo for components
â”‚
â”œâ”€â”€ Code Splitting
â”‚   â”œâ”€â”€ Lazy load modals
â”‚   â”œâ”€â”€ Lazy load emoji picker
â”‚   â””â”€â”€ Lazy load file previews
â”‚
â””â”€â”€ Caching
    â”œâ”€â”€ Cache conversations
    â”œâ”€â”€ Cache messages
    â””â”€â”€ Cache user info

Message Rendering Optimization
â”œâ”€â”€ Virtual scrolling (future)
â”œâ”€â”€ Lazy load images
â”œâ”€â”€ Batch render updates
â””â”€â”€ Cleanup timers/intervals

State Management Optimization
â”œâ”€â”€ Separate concerns
â”œâ”€â”€ Avoid deeply nested state
â”œâ”€â”€ Use local state when possible
â”œâ”€â”€ Clear listeners on unmount
â””â”€â”€ Debounce search input
```

---

## 13. API Contract

### Request/Response Format

**Request**
```json
{
  "method": "POST",
  "url": "/api/conversations/conv-1/messages",
  "headers": {
    "Authorization": "Bearer token",
    "Content-Type": "application/json"
  },
  "body": {
    "content": "Hello",
    "attachments": []
  }
}
```

**Response**
```json
{
  "success": true,
  "data": {
    "id": "msg-123",
    "conversationId": "conv-1",
    "senderId": "user-1",
    "content": "Hello",
    "type": "text",
    "timestamp": "2024-12-17T10:30:00Z",
    "status": "delivered"
  },
  "message": "Message sent successfully"
}
```

---

**Document Generated**: December 17, 2025  
**Version**: 1.0
